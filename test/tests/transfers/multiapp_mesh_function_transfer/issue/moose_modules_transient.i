# block IDs from 6000 + slice*100 to 6042 + slice*100 (slice from 1 to 18)
all_blocks = '
6401 6402 6403 6404 6405 6406 6407 6408 6409 6410 6411 6412 6413 6414 6415 6416 6417 6418 6419 6420 6421 6422 6423 6424 6425 6426 6427 6428 6429 6430 6431 6432 6433 6434 6435 6436 6437 6438 6439 6440 6441 6442
6501 6502 6503 6504 6505 6506 6507 6508 6509 6510 6511 6512 6513 6514 6515 6516 6517 6518 6519 6520 6521 6522 6523 6524 6525 6526 6527 6528 6529 6530 6531 6532 6533 6534 6535 6536 6537 6538 6539 6540 6541 6542
6601 6602 6603 6604 6605 6606 6607 6608 6609 6610 6611 6612 6613 6614 6615 6616 6617 6618 6619 6620 6621 6622 6623 6624 6625 6626 6627 6628 6629 6630 6631 6632 6633 6634 6635 6636 6637 6638 6639 6640 6641 6642
6701 6702 6703 6704 6705 6706 6707 6708 6709 6710 6711 6712 6713 6714 6715 6716 6717 6718 6719 6720 6721 6722 6723 6724 6725 6726 6727 6728 6729 6730 6731 6732 6733 6734 6735 6736 6737 6738 6739 6740 6741 6742
6801 6802 6803 6804 6805 6806 6807 6808 6809 6810 6811 6812 6813 6814 6815 6816 6817 6818 6819 6820 6821 6822 6823 6824 6825 6826 6827 6828 6829 6830 6831 6832 6833 6834 6835 6836 6837 6838 6839 6840 6841 6842
6901 6902 6903 6904 6905 6906 6907 6908 6909 6910 6911 6912 6913 6914 6915 6916 6917 6918 6919 6920 6921 6922 6923 6924 6925 6926 6927 6928 6929 6930 6931 6932 6933 6934 6935 6936 6937 6938 6939 6940 6941 6942
7001 7002 7003 7004 7005 7006 7007 7008 7009 7010 7011 7012 7013 7014 7015 7016 7017 7018 7019 7020 7021 7022 7023 7024 7025 7026 7027 7028 7029 7030 7031 7032 7033 7034 7035 7036 7037 7038 7039 7040 7041 7042
7101 7102 7103 7104 7105 7106 7107 7108 7109 7110 7111 7112 7113 7114 7115 7116 7117 7118 7119 7120 7121 7122 7123 7124 7125 7126 7127 7128 7129 7130 7131 7132 7133 7134 7135 7136 7137 7138 7139 7140 7141 7142
7201 7202 7203 7204 7205 7206 7207 7208 7209 7210 7211 7212 7213 7214 7215 7216 7217 7218 7219 7220 7221 7222 7223 7224 7225 7226 7227 7228 7229 7230 7231 7232 7233 7234 7235 7236 7237 7238 7239 7240 7241 7242
7301 7302 7303 7304 7305 7306 7307 7308 7309 7310 7311 7312 7313 7314 7315 7316 7317 7318 7319 7320 7321 7322 7323 7324 7325 7326 7327 7328 7329 7330 7331 7332 7333 7334 7335 7336 7337 7338 7339 7340 7341 7342
7401 7402 7403 7404 7405 7406 7407 7408 7409 7410 7411 7412 7413 7414 7415 7416 7417 7418 7419 7420 7421 7422 7423 7424 7425 7426 7427 7428 7429 7430 7431 7432 7433 7434 7435 7436 7437 7438 7439 7440 7441 7442
7501 7502 7503 7504 7505 7506 7507 7508 7509 7510 7511 7512 7513 7514 7515 7516 7517 7518 7519 7520 7521 7522 7523 7524 7525 7526 7527 7528 7529 7530 7531 7532 7533 7534 7535 7536 7537 7538 7539 7540 7541 7542
6100 6200 6300 6400 6500 6600 6700 6800 6900 7000 7100 7200 7300 7400 7500 7600 7700 7800
6101 6102 6103 6104 6105 6106 6107 6108 6109 6110 6111 6112 6113 6114 6115 6116 6117 6118 6119 6120 6121 6122 6123 6124 6125 6126 6127 6128 6129 6130 6131 6132 6133 6134 6135 6136 6137 6138 6139 6140 6141 6142
6201 6202 6203 6204 6205 6206 6207 6208 6209 6210 6211 6212 6213 6214 6215 6216 6217 6218 6219 6220 6221 6222 6223 6224 6225 6226 6227 6228 6229 6230 6231 6232 6233 6234 6235 6236 6237 6238 6239 6240 6241 6242
6301 6302 6303 6304 6305 6306 6307 6308 6309 6310 6311 6312 6313 6314 6315 6316 6317 6318 6319 6320 6321 6322 6323 6324 6325 6326 6327 6328 6329 6330 6331 6332 6333 6334 6335 6336 6337 6338 6339 6340 6341 6342
7601 7602 7603 7604 7605 7606 7607 7608 7609 7610 7611 7612 7613 7614 7615 7616 7617 7618 7619 7620 7621 7622 7623 7624 7625 7626 7627 7628 7629 7630 7631 7632 7633 7634 7635 7636 7637 7638 7639 7640 7641 7642
7701 7702 7703 7704 7705 7706 7707 7708 7709 7710 7711 7712 7713 7714 7715 7716 7717 7718 7719 7720 7721 7722 7723 7724 7725 7726 7727 7728 7729 7730 7731 7732 7733 7734 7735 7736 7737 7738 7739 7740 7741 7742
7801 7802 7803 7804 7805 7806 7807 7808 7809 7810 7811 7812 7813 7814 7815 7816 7817 7818 7819 7820 7821 7822 7823 7824 7825 7826 7827 7828 7829 7830 7831 7832 7833 7834 7835 7836 7837 7838 7839 7840 7841 7842
'

[Mesh]
  type = FileMesh
  file = HTTR_new.e
  uniform_refine = 0
[]

[Variables]
  [Tm]
  []
[]

[Functions]
  [./Twall_func]
    type = ParsedFunction
    value = '40*x*(5.22-x)+668' # dummy Twall
  [../]
  [./T_init]
    type = ParsedFunction
    value = '668'
  [../]
[]

[Kernels]
  [./HeatConduction]
    type = HeatConduction
    variable = Tm
  [../]
  [./heat_ie]
    type = HeatConductionTimeDerivative
    variable = Tm
  [../]
[]

[BCs]
  [./outside_bc]
    type = ConvectiveFluxFunction
    variable = Tm
    boundary = '1 2'
    coefficient = 2.615e3
    T_infinity = T_init
  [../]
[]

[AuxVariables]
   [Twall]
   []
[]

[AuxKernels]
  [./twall]
    type = FunctionAux
    function = Twall_func
    variable = Twall
    block = '${all_blocks}'
    execute_on = 'initial'
  [../]
[]

[Materials]
  [./graphite_moderator]
    type = HeatConductionMaterial
    block = ${all_blocks}
    thermal_conductivity = 34.6
    specific_heat = 1700.0
  [../]
  [./graphite_density]
  	type = Density
  	density = 1800
  	block = '${all_blocks}'
  [../]
[]

[Postprocessors]
  [./avg_Tm]
    type = ElementAverageValue
    variable = Tm
    block = '${all_blocks}'
    execute_on = 'initial linear'
  [../]
  [./Tm_in]
    type = PointValue
    point = '5.22 0 0'
    variable = Tm
    execute_on = 'initial linear'
  [../]
  [./Tm_max]
    type = ElementExtremeValue
    value_type = max
    variable = Tm
    block = '${all_blocks}'
    execute_on = 'initial linear'
  [../]
[]

[Executioner]
  type = Transient

  petsc_options_iname = '-pc_type -pc_hypre_type -ksp_gmres_restart '
  petsc_options_value = 'hypre boomeramg 100'
  # petsc_options = '-snes_view -snes_converged_reason -ksp_converged_reason -snes_error_if_not_converged -ksp_error_if_not_converged'

  num_steps = 1
  dt = 0.01
[]


[MultiApps]
  [relap]
    type = TransientMultiApp
    app_type = SabertoothApp
    positions = '0 1.24707658145 0.0'
    # positions_file = 'centers_relap.txt'
    input_files = 'relap.i'
    execute_on = 'initial timestep_end'
    max_procs_per_app = 1
    sub_cycling = true
  []
[]

[Transfers]
  [twall_to_relap]
    type = MultiAppMeshFunctionTransfer
    direction = to_multiapp
    source_variable = Twall
    variable = T_wall
    multi_app = relap
    execute_on = 'initial timestep_end'
  []
[]

[Outputs]
  exodus = true
  csv = true
  perf_graph = true
[]
